<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/template :: head_input(~{::title})">
	<title>Order</title>
</head>
<body>
<th:block th:include="/common/_header"></th:block>
<main>
	<div class="container-fluid">
		<div class="row">
			<th:block th:include="/common/_customer-sidebar-menu"></th:block>
			<div class="col-lg-8">
				<div class="row mb-4">
					<h3 class="text-lg-left mt-lg-2">Make Order</h3>
				</div>
				<div th:replace="fragments/template :: display-error-message"/>
				<div class="row">
					<form th:action="@{/customer/order/create}" method="POST" th:object="${orderForm}" class="d-flex w-100">
						<div class="col-md-8">
<!--							<div class="row border">-->
								<div class="container border">
									<div class="form-row mt-2">
										<div class="col-md-12">
											<span>Payment method</span>
											<div class="form-check">
												<input class="form-check-input" type="radio" name="exampleRadios"
												       id="exampleRadios1" value="option1" checked>
												<span class="icon"></span>
												<label class="form-check-label" for="exampleRadios1">
													Cash
												</label>
											</div>
											<div class="form-check">
												<input class="form-check-input" type="radio" name="exampleRadios"
												       id="exampleRadios2" value="option2">
												<span class="icon"></span>
												<label class="form-check-label" for="exampleRadios2">
													ATM
												</label>
											</div>
										</div>
									</div>
									<hr class="my-2">
									<div class="form-row">
										<div class="col-md-12">
											<span>Transporter unit</span>
											<div class="form-check" th:each="transporter : ${transporterFormList}">
												<input class="form-check-input" type="radio" name="transporterId"
												       id="transporterId"
												       th:value="${transporter.id}" checked>
												<span class="icon"></span>
												<label class="form-check-label" for="transporterId"
												       th:text="${transporter.fullName}"></label>
												<span th:text="'(Shipping fee: ' + ${transporter.shippingFee} + 'Ä‘)'"></span>
												<input type="hidden" th:id="'shippingFeeValue'+${transporter.id}"
												       th:value="${transporter.shippingFee}">
											</div>
										</div>
									</div>
									<hr class="my-2">
									<div class="form-row">
										<div class="col-12 form-group">
											<label for="note">Note: </label>
											<textarea class="form-control" id="note" type="text" th:field="*{note}" style="height: 8em;"
											          placeholder="Enter note"></textarea>
										</div>
									</div>
								</div>
<!--							</div>-->
						</div>
						<div class="col-md-4">
							<div class="address container border mb-4">
								<div class="title mt-2">
									<span>Delivery address</span>
								</div>
								<hr class="my-2">
								<div class="content clearfix" th:unless="${defaultAddress eq null}">
									<span class="name" th:text="${defaultAddress.getFullName()}"></span>
									<span class="phoneNumber float-right"
									      th:text="${defaultAddress.phoneNumber}"></span>
									<span class="detail d-block"
									      th:text="${defaultAddress.addressDetail}+', '+${defaultAddress.ward}+', '+${defaultAddress.district}+', '+${defaultAddress.province}"></span>
									<input type="hidden" th:name="addressId" th:id="addressId"
									       th:value="${defaultAddress.id}">
									<div><a th:href="@{/customer/address/change}" th:text="Change"
									        role="button" class="btn  green darken-3 text-light"></a>
									</div>
								</div>
								<div class="content clearfix" th:if="${defaultAddress eq null}">
									<a role="button" class="btn btn-primary"
									   th:href="@{/customer/address/initAddAddress}" th:text="'Add address'"></a>
								</div>
							</div>
							<div class="cart container border ">
								<div class="title mt-2">
									<span th:text="'Order (' + *{cartInfoForm.getQuantityTotal()} + ' products)'"></span>
								</div>
								<hr class="my-2">
								<div class="product row"
								     th:each="cartLine : *{cartInfoForm.cartLines}">
									<div class="info col-sm-8 pr-0">
										<span th:text="${cartLine.buyQuantity  + 'x '}"></span>
										<a th:href="@{/product/view/detail(productId = ${cartLine.productForm.productId}, vendorId = ${cartLine.productForm.vendorId})}">
											<span th:text="${cartLine.productForm.productName}"></span>
										</a>
										<span style="display: block">Provided by <strong
												th:text="${cartLine.productForm.vendorName}"></strong></span>
									</div>
									<div class="price col-sm-4 text-right money"
									     th:text="${cartLine.productForm.price}"></div>
									<!--                        <input type="hidden" name="carLineId" id="cartLineId" th:value="${cartLine.id}">-->
									<!--                        <input type="hidden" name="quantity" id="quantity" th:value="${cartLine.productForm.quantity}">-->
								</div>
								<hr class="my-2">
								<div class="price-summary clearfix mb-1 pl-5 text-right">
									<div class="total-list-price d-flex">
										<div class="name w-50">Total price:</div>
										<div class="money value w-50" id="totalTemp"
										     th:text="*{cartInfoForm.getBillTotal()}"></div>
									</div>
									<div class="shipping-cost d-flex">
										<div class="name w-50">Shipping fee:</div>
										<div class="moneyTemp money w-50" id="shippingFeeDsp" value="0"></div>
									</div>
									<div class="bill-total d-flex">
										<div class="name w-50">Total bill:</div>
										<div class="moneyTemp value w-50" id="total"
										     th:text="*{cartInfoForm.getBillTotal()}"></div>
									</div>
								</div>
								<input type="hidden" th:name="shippingFee" th:id="shippingFee" value="">
								<button type="submit" class="btn btn-primary"
								        th:classappend="${defaultAddress eq null} ? 'disabled':''">Make order
								</button>
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</main>
<th:block th:include="/common/_footer"></th:block>
<!--<div th:text="'Total:' + ${orderForm.getCartInfoForm().getBillTotal()}"></div>-->

<div th:replace="fragments/template::common-redirect-form"></div>
<div th:replace="fragments/template::overlay"></div>
<script type="text/javascript" th:inline="javascript">
    const cartInfoForm = [[${orderForm.getCartInfoForm().getCartLines()}]];
    const totalTemp = [[${orderForm.getCartInfoForm().getBillTotal()}]];
</script>
</body>
<script type="text/javascript" th:src="@{/js/customer/order/orderPage.js}"></script>
<link rel="stylesheet" type="text/css" media="all" th:href="@{/css/customer/order/orderPage.css}"
      href="../../../static/css/customer/order/orderPage.css">
</html>